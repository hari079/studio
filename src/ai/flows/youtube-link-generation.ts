// This is an autogenerated file from Firebase Studio.
'use server';

/**
 * @fileOverview Generates YouTube video links related to food storage based on chat history.
 *
 * - generateYoutubeLinks - A function that generates YouTube video links.
 * - GenerateYoutubeLinksInput - The input type for the generateYoutubeLinks function.
 * - GenerateYoutubeLinksOutput - The return type for the generateYoutubeLinks function.
 */

import {ai} from '@/ai/genkit';
import {z} from 'genkit';

const GenerateYoutubeLinksInputSchema = z.object({
  chatHistory: z
    .string()
    .describe('The complete chat history between the user and the chatbot.'),
});
export type GenerateYoutubeLinksInput = z.infer<typeof GenerateYoutubeLinksInputSchema>;

const GenerateYoutubeLinksOutputSchema = z.object({
  videoLinks: z
    .array(z.string()) // Removed .url() here
    .describe('An array of YouTube video links related to food storage.'),
});
export type GenerateYoutubeLinksOutput = z.infer<typeof GenerateYoutubeLinksOutputSchema>;

export async function generateYoutubeLinks(input: GenerateYoutubeLinksInput): Promise<GenerateYoutubeLinksOutput> {
  return generateYoutubeLinksFlow(input);
}

const prompt = ai.definePrompt({
  name: 'youtubeLinkGenerationPrompt',
  input: {schema: GenerateYoutubeLinksInputSchema},
  output: {schema: GenerateYoutubeLinksOutputSchema},
  prompt: `Given the following chat history about food storage, generate a list of relevant YouTube video links that would be helpful to the user.\n\nChat History:\n{{{chatHistory}}}\n\nRespond with a JSON object containing a "videoLinks" array of YouTube video URLs. Ensure each item in the "videoLinks" array is a valid YouTube URL string.`,
});

const generateYoutubeLinksFlow = ai.defineFlow(
  {
    name: 'generateYoutubeLinksFlow',
    inputSchema: GenerateYoutubeLinksInputSchema,
    outputSchema: GenerateYoutubeLinksOutputSchema,
  },
  async input => {
    const {output} = await prompt(input);
    return output!;
  }
);
